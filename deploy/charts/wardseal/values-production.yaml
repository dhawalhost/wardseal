# Production Environment Values
# Override default values for production deployment

global:
  imageRegistry: ghcr.io/dhawalhost

# Database - Production
database:
  host: postgres-production.wardseal.svc.cluster.local
  port: 5432
  name: identity_platform
  sslMode: verify-full
  existingSecret: wardseal-db-credentials-production

# Auth Service - Production
authsvc:
  enabled: true
  replicaCount: 3

  image:
    tag: ""  # Set by CI during deployment

  env:
    LOG_LEVEL: info
    DIRECTORY_SERVICE_URL: http://wardseal-dirsvc:8081
    AUTH_SERVICE_URL: https://auth.wardseal.com
    REQUIRE_LICENSE: "true"

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70

# Directory Service - Production
dirsvc:
  enabled: true
  replicaCount: 3

  image:
    tag: ""

  env:
    LOG_LEVEL: info

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 15
    targetCPUUtilizationPercentage: 70

# Governance Service - Production
govsvc:
  enabled: true
  replicaCount: 3

  image:
    tag: ""

  env:
    LOG_LEVEL: info
    DIRECTORY_SERVICE_URL: http://wardseal-dirsvc:8081

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 15
    targetCPUUtilizationPercentage: 70

# Ingress - Production
ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/rate-limit-window: "1m"
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: auth.wardseal.com
      paths:
        - path: /
          pathType: Prefix
          service: authsvc
          port: 8080
    - host: api.wardseal.com
      paths:
        - path: /api/v1/users
          pathType: Prefix
          service: dirsvc
          port: 8081
        - path: /api/v1/groups
          pathType: Prefix
          service: dirsvc
          port: 8081
        - path: /api/v1/oauth
          pathType: Prefix
          service: govsvc
          port: 8082
        - path: /api/v1/governance
          pathType: Prefix
          service: govsvc
          port: 8082
  tls:
    - secretName: wardseal-tls-production
      hosts:
        - auth.wardseal.com
        - api.wardseal.com

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 2
